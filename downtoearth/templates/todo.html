{% extends "layout.html" %}
{% block includes %}
    <script src="{{url_for('static',filename = 'js/doT.min.js')}}"></script>
    <script src="{{url_for('static',filename = 'js/dot_templates.js')}}"></script>
    <script src="{{url_for('static',filename = 'js/holder.js')}}"></script>
    <script src="http://code.jquery.com/ui/1.10.3/jquery-ui.js"></script>
{% endblock %}
{% block body %}
<div class="container-fluid">
    <div id="items_list">
    </div>
        <script type="text/javascript">
            $(document).ready(function() {
                $.post('/api/list/comments', {'store_name': "{{data.store_name}}" },function(data) {
                    console.log(data);
                    $('#items_list').html(comments_list(data));
                    $('#accordion').accordion();
                    $('a.thumbs').click(function() {
                        if($(this).attr('data-ud') == 'up') {
                            $.post('/api/up_vote', {'item_id': $(this).attr('data-item-id'), 'comment_id': $(this).attr('data-c-id')}, function(data1) {
                                window.location.href = "/restaurants/{{data.store_name}}"
                            });
                        } else {
                            $.post('/api/down_vote', {'item_id': $(this).attr('data-item-id'), 'comment_id': $(this).attr('data-c-id')}, function(data1) {
                                window.location.href = "/restaurants/{{data.store_name}}"
                            });
                        }
                    });
                });
                $(".commentSubmit").click(function() {
                    if($(".comment").val()!="") {
                        $.post("/api/addcomment", {'item_id': '{{data.id}}', 'comment': $('#comment').val()}, function() {
                            window.location.href = "restaurants/{{data.store_name}}"
                        });
                    }
                });
            });
        </script>
</div>

{% endblock %}